<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>æ²‰é»˜æ¡£æ¡ˆï¼š2586</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <!-- ğŸ”¹ å¼€åœºæ–‡å­—ä»‹ç» -->
  <div id="intro" class="overlay">
    <h1 class="title">2586å¹´ï½œä¿¡æ¯æˆ˜äº‰åçš„æ®‹å­˜æ•°æ®é‡å»ºè¡ŒåŠ¨</h1>
    <div class="mission-text">
        <p>ä½ æ˜¯ä¸€å"å†å²è€ƒå¤è€…"</p>
        <p>ä»»åŠ¡ï¼šè¿½æº¯åœ°çƒæ—§æ–‡æ˜ä¸­çš„ä¸€èµ·é‡å¤§äº‹ä»¶ â€”â€” "åœ°éœ‡æ•‘æ´ç¥è¯"</p>
        <p>ç›®æ ‡ï¼šæŒ–æ˜ç¢ç‰‡ä¹‹ä¸­è¢«é—å¿˜çš„çœŸå®æƒ…ç»ªä¸ä¸ªä½“å‘½è¿</p>
        <p class="warning">è¯·è°¨æ…ç”„åˆ«ï¼šä½ çœ‹åˆ°çš„ï¼Œä¸ä¸€å®šæ˜¯çœŸç›¸</p>
    </div>
    <button id="start-btn">å¼€å§‹æ¢ç´¢</button>
  </div>

  <!-- ğŸ”¹ ä¸»åœºæ™¯ï¼ˆåˆå§‹éšè—ï¼‰ -->
  <div id="main-scene" class="hidden">
    <canvas id="p5-canvas"></canvas>
    <!-- å¯åŠ¨æ€æ·»åŠ äº¤äº’æ¨¡å— -->
  </div>

  <!-- æ·»åŠ èƒŒæ™¯éŸ³ä¹ -->
  <audio id="bgm" loop>
    <source src="assets/audio/main_bgm.mp3" type="audio/mpeg">
  </audio>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <script src="sketch.js"></script>
  <script src="logic.js"></script>
  <script src="parallax.js"></script>
  <script src="typewriter.js"></script>

  <script>
    // è®¾ç½®èƒŒæ™¯éŸ³ä¹
    const bgm = document.getElementById('bgm');
    bgm.volume = 0.15; // è®¾ç½®éŸ³é‡ä¸º15%

    // å½“æ–‡å­—å¼€å§‹å‡ºç°æ—¶æ’­æ”¾èƒŒæ™¯éŸ³ä¹
    const observer = new MutationObserver((mutations) => {
        const missionText = document.querySelector('.mission-text');
        if (missionText && missionText.textContent.includes('ä½ æ˜¯ä¸€å"å†å²è€ƒå¤è€…"')) {
            bgm.play().catch(error => {
                console.error('èƒŒæ™¯éŸ³ä¹æ’­æ”¾å¤±è´¥:', error);
            });
            observer.disconnect(); // åœæ­¢è§‚å¯Ÿ
        }
    });

    // å¼€å§‹è§‚å¯Ÿæ–‡å­—å˜åŒ–
    observer.observe(document.body, { 
        childList: true, 
        subtree: true,
        characterData: true 
    });

    // å¤„ç†å¼€å§‹æ¢ç´¢æŒ‰é’®ç‚¹å‡»
    document.getElementById('start-btn').addEventListener('click', function() {
        // ä¿å­˜å½“å‰éŸ³ä¹æ’­æ”¾ä½ç½®
        localStorage.setItem('bgmTime', bgm.currentTime);
        // è·³è½¬åˆ°ä¸‹ä¸€ä¸ªé¡µé¢
        window.location.href = './scene1.html';
    });
  </script>
</body>
</html>
